---
import Layout from "@/layouts/Layout.astro";
import Header from "@/components/Header.astro";
import Footer from "@/components/Footer.astro";
import Hr from "@/components/Hr.astro";
import Card from "@/components/Card.astro";
import Testimonial from "@/components/Testimonial.astro";
import { getCollection } from "astro:content";
import getSortedPosts from "@/utils/getSortedPosts";

// Get recent blog posts
const posts = await getCollection("blog", ({ data }) => !data.draft);
const sortedPosts = getSortedPosts(posts);
const recentPosts = sortedPosts.slice(0, 5);
---

<Layout
  title="Igor Tarasenko - Engineer & Solution Architect"
  description="16 years building complete solutions—iOS, backend, and AI. I help teams solve their hardest technical problems. WhisperBoard creator. Ex-Uber."
>
  <Header />
  <main id="main-content" class="mx-auto max-w-4xl px-4">
    <section id="hero" class="py-20 space-y-6">
      <div class="space-y-2">
        <h1 class="text-5xl font-bold leading-tight">Hey, I'm Igor</h1>
        <h2 class="text-2xl text-foreground/80">Engineer &amp; Solution Architect</h2>
      </div>
      <p class="text-lg text-foreground/80">
        16 years building software. I help teams ship complete solutions and solve complex technical problems—from iOS architecture to on-device AI.
      </p>
      <p class="text-lg text-foreground/80">
        I find where technology creates leverage and make it real.
      </p>
      <p class="text-sm text-foreground/70">
        Currently: WhisperBoard (50k+ downloads, 4.8★). Previously: Uber.
      </p>
      <div class="flex flex-col gap-3 sm:flex-row sm:items-center">
        <a
          class="inline-flex items-center justify-center rounded-md bg-accent px-5 py-3 text-sm font-semibold text-background transition hover:opacity-90"
          href="/consulting"
        >
          Book Consultation
        </a>
        <a
          class="inline-flex items-center justify-center rounded-md border border-border px-5 py-3 text-sm font-semibold text-foreground transition hover:border-foreground"
          href="/about"
        >
          More About Me
        </a>
      </div>
    </section>

    <Hr />

    <Testimonial
      quote="Igor was so great to work with! We were able to figure out the solution to something we've been stuck on for over 2 days in less than an hour!"
      author="Alina Liu"
    />

    <section id="recent-posts" class="py-12 space-y-6">
      <h2 class="text-2xl font-semibold">Recent Posts</h2>
      <p class="text-sm text-foreground/70">
        Writing about iOS architecture, AI coding workflows, and on-device ML. <a class="text-accent" href="/posts">View all →</a>
      </p>
      <ul class="space-y-6">
        {recentPosts.map(post => (
          <li>
            <Card {...post} />
          </li>
        ))}
      </ul>
    </section>

    <Hr />

    <section class="py-12">
      <p class="text-sm text-foreground/70">
        I also offer high-impact, async-first consulting for a small number of clients.{" "}
        <a class="text-accent" href="/consulting">Learn more →</a>
      </p>
    </section>
  </main>
  <Footer />
</Layout>
